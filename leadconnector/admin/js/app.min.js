(function(e){function t(t){for(var s,a,o=t[0],r=t[1],d=t[2],u=0,h=[];u<o.length;u++)a=o[u],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&h.push(n[a][0]),n[a]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);c&&c(t);while(h.length)h.shift()();return l.push.apply(l,d||[]),i()}function i(){for(var e,t=0;t<l.length;t++){for(var i=l[t],s=!0,o=1;o<i.length;o++){var r=i[o];0!==n[r]&&(s=!1)}s&&(l.splice(t--,1),e=a(a.s=i[0]))}return e}var s={},n={app:0},l=[];function a(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=s,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=r;l.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("cd49")},"0a9e":function(e,t,i){},5640:function(e,t,i){"use strict";i("83d3")},6538:function(e,t,i){"use strict";i("0a9e")},"83d3":function(e,t,i){},"95b1":function(e,t,i){"use strict";i("f6c0")},cd49:function(e,t,i){"use strict";i.r(t);var s=i("2b0e"),n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{attrs:{id:"app"}},[t("h1",[e._v("LeadConnector Settings")]),t("Settings",{attrs:{enableTextWidget:e.settings.enable_text_widget,apiKey:e.settings.api_key,baseURL:e.settings.base_URL}})],1)},l=[],a=(i("b7ef"),i("9ab4")),o=i("1b40"),r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"lead-connector-settings",attrs:{id:"lead-connector-settings"}},[t("div",{staticClass:"oauth-authorization-row"},[t("a",{attrs:{href:this.oAuthUrl,target:"_blank"}},[t("b-button",[e._v(" "+e._s(this.isAuthorizing?"Authorizing":"Authorize")+" "),t("b-icon-box-arrow-up-right")],1),t("b-modal",{attrs:{id:"oauth-modal"}},[t("h2",[e._v("Authorizing ......")])])],1)]),t("div",{staticClass:"api-key-input-contaier"},[t("b-form-group",{attrs:{id:"fieldset-api-input",description:"You'll find the API key under location level -> settings -> Company page",label:"API key","label-for":"api-key-input","label-align":"left","invalid-feedback":e.apiErrorMessage}},[t("b-col",{staticStyle:{padding:"0"},attrs:{sm:"12",lg:"6"}},[t("b-form-input",{attrs:{id:"api-key-input",placeholder:"enter API key",state:e.isvalidApi},model:{value:e.api_key,callback:function(t){e.api_key=t},expression:"api_key"}}),t("b-form-invalid-feedback",{attrs:{id:"api-key-input-feedback"}},[t("span",{domProps:{innerHTML:e._s(e.apiErrorMessage)}})])],1)],1),this.isAPIsaving?t("b-spinner",{staticClass:"align-middle text-success my-2"}):t("b-button",{attrs:{variant:"success"},on:{click:function(t){return e.saveAPI()}}},[e._v(" Save")])],1),t("div",{staticClass:"accordion",attrs:{role:"tablist"}},[t("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[t("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[t("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-1",modifiers:{"accordion-1":!0}}],staticClass:"hl_wrapper-text-widget--toggle",attrs:{block:"",variant:"info"}},[t("div",[t("b-icon-chat-left"),t("span",{staticClass:"header-text"},[e._v("Chat Widget")])],1),e.visible1?t("b-icon",{attrs:{icon:"chevron-down"}}):e._e(),e.visible1?e._e():t("b-icon",{attrs:{icon:"chevron-right"}})],1)]),t("b-collapse",{attrs:{id:"accordion-1",accordion:"my-accordion",role:"tabpanel"},model:{value:e.visible1,callback:function(t){e.visible1=t},expression:"visible1"}},[t("b-card-body",[t("div",{staticClass:"chat-widget-setting-root"},[t("input",{attrs:{type:"hidden",name:"enable_text_widget",value:"0"}}),t("b-form-checkbox",{attrs:{id:"lead_connector_setting_enable_text_widget",name:"enable_text_widget",value:"1","unchecked-value":"0"},model:{value:e.chatWidgetEnable,callback:function(t){e.chatWidgetEnable=t},expression:"chatWidgetEnable"}},[e._v(" Enable Chat-widget ")]),this.isAPIsaving?t("b-spinner",{staticClass:"align-middle text-primary my-2"}):t("b-button",{on:{click:function(t){return e.saveAPI(t)}}},[e._v(" "+e._s("1"===e.chatWidgetEnable?"Pull and Save":"Save"))]),t("label",{staticStyle:{"font-size":"10px"}},[t("p",{staticStyle:{"margin-top":"5px"}},[e._v(" We will fetch the latest settings from your account ")])]),t("p",{staticClass:"text-warning mb-0"},[e._v(e._s(this.chatWidgetWarning))])],1)])],1)],1),t("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[t("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[t("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-2",modifiers:{"accordion-2":!0}}],staticClass:"hl_wrapper-text-widget--toggle",attrs:{block:"",variant:"info"}},[t("div",[t("b-icon-funnel"),t("span",{staticClass:"header-text"},[e._v("Funnels")])],1),e.visible2?t("b-icon",{attrs:{icon:"chevron-down"}}):e._e(),e.visible2?e._e():t("b-icon",{attrs:{icon:"chevron-right"}})],1)]),t("b-collapse",{attrs:{id:"accordion-2",accordion:"my-accordion",role:"tabpanel"},model:{value:e.visible2,callback:function(t){e.visible2=t},expression:"visible2"}},[t("b-card-body",[t("div",[t("b-table",{ref:"selectableTable",attrs:{striped:"",hover:"",busy:e.isBusy,items:this.publishedPages,"sticky-header":"",fields:e.publishedPageTablefields,"select-mode":"single","selected-variant":""},scopedSlots:e._u([{key:"table-busy",fn:function(){return[t("div",{staticClass:"text-center text-success my-2"},[t("b-spinner",{staticClass:"align-middle"}),t("strong",[e._v("Loading...")])],1)]},proxy:!0},{key:"cell(slug)",fn:function(t){return[e._v(" "+e._s("/"+t.item.slug)+" ")]}},{key:"cell(url)",fn:function(i){return[t("div",[t("a",{attrs:{active:"false",href:""+i.item.url,target:"_blank"}},[e._v("View ")]),t("b-icon-box-arrow-up-right")],1)]}},{key:"cell(context)",fn:function(i){return[t("b-button",{staticClass:"no-border",attrs:{variant:"outline-danger"},on:{click:function(t){return e.deletePost(t,i.item)}}},[t("b-icon-trash",{directives:[{name:"b-modal",rawName:"v-b-modal.confirm-post-delete",modifiers:{"confirm-post-delete":!0}}]})],1),t("b-button",{staticClass:"no-border",attrs:{variant:"outline-secondary"},on:{click:function(t){return e.editFunnel(t,i.item)}}},[t("b-icon-pencil-square")],1)]}},{key:"cell(edit_url)",fn:function(i){return[t("div",[t("a",{attrs:{href:`${e.hostURL}/location/${e.location_id}/funnels-websites/funnels/${i.item.lc_funnel_id}/steps/${i.item.lc_step_id}`,target:"_blank"}},[e._v("Edit")]),t("b-icon-box-arrow-up-right")],1)]}},{key:"cell(selected)",fn:function({rowSelected:i,index:s}){return[i?[t("input",{key:s+"selected",attrs:{type:"checkbox",checked:""},on:{change:function(t){return e.onTableCheckBox(t,s)}}}),t("span",{staticClass:"sr-only"},[e._v("Selected")])]:[t("input",{key:s+"un - selected",attrs:{type:"checkbox"},on:{change:function(t){return e.onTableCheckBox(t,s)}}}),t("span",{staticClass:"sr-only"},[e._v("Not selected")])]]}}])}),t("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.handleAddNewFunnel(t,1)}}},[e._v("Add New")])],1)])],1)],1)],1),this.showAddNewFunnelModal?t("PublishFunnel",{attrs:{showModal:this.showAddNewFunnelModal,onClose:this.onModalClose,funnelOptions:this.funnels,editPost:this.editPost,home_url:this.home_url,host_url:this.hostURL}}):e._e(),t("b-modal",{attrs:{id:"confirm-post-delete",title:"Delete Page ?",centered:""},on:{ok:this.onPostDelete}},[t("p",{staticClass:"my-4"},[e._v(" Are you sure you want to delete this page from wordpress? ")])]),t("b-alert",{staticClass:"position-fixed fixed-bottom m-0 rounded-0",staticStyle:{"z-index":"2000"},attrs:{dismissible:"",variant:e.alertVariant},model:{value:e.showAlertTimer,callback:function(t){e.showAlertTimer=t},expression:"showAlertTimer"}},[e._v(" "+e._s(this.alertTitle)+" ")])],1)},d=[],c=(i("88a7"),i("271a"),i("5494"),function(){var e=this,t=e._self._c;e._self._setupProxy;return t("b-modal",{attrs:{title:"Add New Page",size:"lg",visible:this.showModal,"ok-only":"","ok-title":"Save Page","ok-variant":"success",busy:!(e.selectedFunnel&&e.selectedStep&&e.selectedMethod&&e.pageSlug),scrollable:"",centered:""},on:{close:this.onCloseModal,change:this.onModalChange,ok:this.onOk},scopedSlots:e._u([this.isSubmitting?{key:"modal-footer",fn:function(){return[t("div",{staticClass:"text-center text-success my-2"},[t("b-spinner",{staticClass:"loadgin-spinner"}),t("strong",[e._v("Publishing Funnel...")])],1)]},proxy:!0}:null],null,!0)},[t("p",{staticClass:"my-4"},[t("b-form-group",{attrs:{id:"fieldset-funnel-input",description:"Choose the funnel you want to publish as wordpress page",label:"Choose funnel","label-for":"funnel-input"}},[t("b-form-select",{attrs:{id:"funnel-input",options:this.funnels,"value-field":"_id","text-field":"name"},on:{change:this.onFunnelChange},scopedSlots:e._u([{key:"first",fn:function(){return[t("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Please select a Funnel --")])]},proxy:!0}]),model:{value:e.selectedFunnel,callback:function(t){e.selectedFunnel=t},expression:"selectedFunnel"}})],1),t("span",[e._v(" Funnel : "+e._s(e.selectedFunnel))]),t("b-form-group",{attrs:{id:"fieldset-funnel-step-input",description:"Choose the funnel step",label:"Choose Step","label-for":"funnel-step-input"}},[t("b-form-select",{attrs:{id:"funnel-step-input",disabled:!this.selectedFunnel,options:this.steps,"value-field":"id","text-field":"name"},on:{change:this.onStepChange},scopedSlots:e._u([{key:"first",fn:function(){return[t("b-form-select-option",{attrs:{value:null,disabled:""}},[e.loadingStep?t("span",[e._v("loading funnel steps...")]):t("span",[e._v("-- Please select a Funnel step--")])])]},proxy:!0}]),model:{value:e.selectedStep,callback:function(t){e.selectedStep=t},expression:"selectedStep"}}),e.loadingStep?t("span",{staticClass:"loading-steps-spinner"},[t("b-spinner",{staticClass:"loading-steps-spinner",attrs:{small:"",label:"Loading..."}})],1):e._e()],1),t("b-form-group",{attrs:{id:"fieldset-funnel-display-method-input",description:"Choose the display method",label:"Page Display Method","label-for":"funnel-display-method-input"}},[t("b-form-select",{attrs:{id:"funnel-display-method-input",disabled:!this.selectedFunnel,options:this.displayMethod},scopedSlots:e._u([{key:"first",fn:function(){return[t("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Please select a Page Display Method--")])]},proxy:!0}]),model:{value:e.selectedMethod,callback:function(t){e.selectedMethod=t},expression:"selectedMethod"}})],1),"iframe"===this.selectedMethod?t("b-form-group",{attrs:{id:"fieldset-funnel-include-tracking-code",description:"If enabled, the tracking code in funnel will track wordpress as well",label:"Tracking code","label-for":"include-tracking-code-input"}},[t("b-form-checkbox",{attrs:{id:"include-tracking-code-input",disabled:!e.selectedFunnel,name:"tracking-code-input",value:"1","unchecked-value":"0"},model:{value:e.includeTrackingCode,callback:function(t){e.includeTrackingCode=t},expression:"includeTrackingCode"}},[e._v(" Include Tracking Code ")])],1):e._e(),t("b-form-group",{attrs:{id:"fieldset-funnel-slug_input",description:this.home_url+"/"+(this.pageSlug?this.pageSlug:""),label:"Custom Slug","label-for":"funnel-slug-input","invalid-feedback":e.inValidSlugMessage}},[t("b-form-input",{attrs:{id:"funnel-slug-input",placeholder:"enter slug",disabled:!this.selectedFunnel,formatter:this.slugFormatter,state:e.isvalidSlug},model:{value:e.pageSlug,callback:function(t){e.pageSlug=t},expression:"pageSlug"}})],1),t("b-form-group",{attrs:{id:"fieldset-funnel-preview-url",description:"For referene only *",label:"Preview URL","label-for":"funnel-preview-input"}},[t("b-form-input",{attrs:{id:"funnel-preview-input",placeholder:"Preview URL",disabled:""},model:{value:e.pagePreviewURL,callback:function(t){e.pagePreviewURL=t},expression:"pagePreviewURL"}})],1)],1)])}),u=[];const h="It seems like your account's Permalink Settings set to 'plain', please change it in order to use this plugin, more info <a href='https://wordpress.org/support/article/settings-permalinks-screen/' target='_blank'>here.</a>",p=function(e,t,i=!1){const s=window.lc_admin_settings;let n=`${s.proxy_url}?endpoint=${encodeURIComponent(e)}&_wpnonce=${s.nonce}&direct_endpoint=${String(i)}`;return t&&(n=n+"&data="+JSON.stringify(t)),console.log({apiURL:n}),n},g={STEP_NAME:"lc_step_name",FUNNEL_NAME:"lc_funnel_name",PAGE_URL:"url",EDIT_URL:"edit_url",MODIFIED_DATE:"human_modified_date",CONTEXT:"context",SLUG:"slug"},b=[{key:g.STEP_NAME,label:"Page",sortable:!0},{key:g.FUNNEL_NAME,label:"Funnel Name",sortable:!0},{key:g.SLUG,label:"Slug",sortable:!0},{key:g.PAGE_URL,label:"View",sortable:!0},{key:g.EDIT_URL,label:"Edit",sortable:!1},{key:g.MODIFIED_DATE,label:"Last Modified",sortable:!0},{key:g.CONTEXT,label:"",sortable:!1}],_=["iframe","redirect"],f=[{value:_[0],text:"Embed Full Page iFrame"},{value:_[1],text:"Redirect to Funnel URL"}],v={INVALID_API_KEY:"API key is invalid",FUNNELS_API_FAIL:"Failed to fetch the funnels from you account",NO_FUNNELS:"You don't have any funnels in your account",POSTS_API_FAIL:"Failed to fetch the Pages",DELETE_POST_API_FAIL:"Failed to delete the post",POST_DELETED_SUCCESS:"Post deleted successfully",POST_CREATED_SUCCESS:"Post created successfully",POST_UPDATED_SUCCESS:"Post updated successfully"},m="6705407d183014f80462d9f1-m20kdypv",y="http://localhost:9610/wordpress/lc-plugin/callback",w=window.location.origin,S="https://staging-hl-marketplace--wordpress-f1fwx1ha.web.app",P=S+"/oauth/chooselocation?response_type=code&redirect_uri="+y+"&client_id="+m+"&scope=funnels/funnel.readonly%20wordpress.site.readonly&state="+w;let k=class extends o["c"]{constructor(){super(...arguments),this.selectedFunnel=null,this.selectedStep=null,this.loadingStep=!1,this.selectedMethod=_[0],this.pageSlug=null,this.pagePreviewURL=null,this.selecetdFunnelDetails=null,this.selecetdStepDetails=null,this.editablePost=!1,this.isBusy=!0,this.funnels=[],this.steps=[],this.displayMethod=f,this.isvalidSlug=null,this.inValidSlugMessage="",this.isSubmitting=!1,this.includeTrackingCode="1"}mounted(){this.funnels=this.funnelOptions,this.editPost&&(this.editablePost=!0,this.editPost.slug&&(this.pageSlug=this.editPost.slug),this.editPost.lc_funnel_id&&(this.selectedFunnel=this.editPost.lc_funnel_id,this.onFunnelChange(this.selectedFunnel)),this.editPost.lc_step_id&&(this.selectedStep=this.editPost.lc_step_id,this.pagePreviewURL=`${this.host_url}/v2/preview/${this.editPost.lc_step_id}`),this.editPost.lc_display_method&&(this.selectedMethod=this.editPost.lc_display_method),this.editPost.lc_include_tracking_code&&"0"!==this.editPost.lc_include_tracking_code||(this.includeTrackingCode="0"))}onFunnelChange(e){this.selectedFunnel=e,this.selectedStep=null,this.pagePreviewURL="";const t=this.funnels.find(t=>t._id===e);t&&(this.selecetdFunnelDetails=t,this.steps=t.steps,this.loadingStep=!1)}onStepChange(e){this.selectedStep=e;const t=this.steps.find(e=>e.id===this.selectedStep);this.selecetdStepDetails=t,this.selecetdStepDetails&&(this.selecetdFunnelDetails&&this.selecetdFunnelDetails.domainURL?this.pagePreviewURL=`https://${this.selecetdFunnelDetails.domainURL}${this.selecetdStepDetails.url}`:this.pagePreviewURL=`${this.host_url}/v2/preview/${this.selecetdStepDetails.id}`)}slugFormatter(e){e=e.toLowerCase().replace(/\s/g,"-");let t=e.replace(/^\s+|\s+$/g,"");t=t.toLowerCase();const i="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",s="aaaaeeeeiiiioooouuuunc------";for(let n=0,l=i.length;n<l;n++)t=t.replace(new RegExp(i.charAt(n),"g"),s.charAt(n));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),t}onCloseModal(){this.onClose&&this.onClose(!1)}onModalChange(e){e||this.onClose&&this.onClose(!1)}async onOk(e){var t,i,s,n,l,a,o,r;e.preventDefault(),this.isvalidSlug=null,this.inValidSlugMessage="",this.isSubmitting=!0;const d=await fetch(p("wp_insert_post"),{method:"POST",body:JSON.stringify({lc_step_url:this.pagePreviewURL,lc_slug:this.pageSlug,lc_step_id:null===(t=this.selecetdStepDetails)||void 0===t?void 0:t.id,lc_funnel_id:null===(i=this.selecetdFunnelDetails)||void 0===i?void 0:i._id,lc_step_name:null===(s=this.selecetdStepDetails)||void 0===s?void 0:s.name,lc_funnel_name:null===(n=this.selecetdFunnelDetails)||void 0===n?void 0:n.name,template_id:this.editablePost&&this.editPost?this.editPost.template_id:-1,lc_display_method:this.selectedMethod,lc_step_meta:null===(l=this.selecetdStepDetails)||void 0===l?void 0:l.meta,lc_step_page_download_url:null===(a=this.selecetdStepDetails)||void 0===a?void 0:a.pageDataDownloadURL,lc_include_tracking_code:this.includeTrackingCode,lc_funnel_tracking_code:{headerCode:btoa((null===(o=this.selecetdFunnelDetails)||void 0===o?void 0:o.tracking_code_head)||""),footerCode:btoa((null===(r=this.selecetdFunnelDetails)||void 0===r?void 0:r.tracking_code_body)||"")}})});this.isSubmitting=!1,d.ok&&d.text().then(e=>{let t={};try{t=JSON.parse(e)}catch(i){return void console.log("fail to parse response",e,i)}if(t.error){if(1009===t.code){this.isvalidSlug=!1;const e=this.pageSlug+"-"+~~(10*Math.random());this.inValidSlugMessage=t.message+", try using "+e,this.pageSlug=e}}else this.onClose&&this.onClose(!0)})}};Object(a["a"])([Object(o["b"])()],k.prototype,"showModal",void 0),Object(a["a"])([Object(o["b"])()],k.prototype,"onClose",void 0),Object(a["a"])([Object(o["b"])()],k.prototype,"funnelOptions",void 0),Object(a["a"])([Object(o["b"])()],k.prototype,"editPost",void 0),Object(a["a"])([Object(o["b"])()],k.prototype,"home_url",void 0),Object(a["a"])([Object(o["b"])()],k.prototype,"host_url",void 0),k=Object(a["a"])([o["a"]],k);var C=k,x=C,A=(i("5640"),i("2877")),E=Object(A["a"])(x,c,u,!1,null,"3954d822",null),T=E.exports;let O=class extends o["c"]{constructor(){super(...arguments),this.showAddNewFunnelModal=!1,this.isBusy=!1,this.visible1=!0,this.visible2=!1,this.showConfirmPostDelete=!1,this.isAPIsaving=!1,this.isvalidApi=null,this.editPost=null,this.chatWidgetEnable=String(this.enableTextWidget),this.api_key="",this.location_id="",this.home_url="",this.apiErrorMessage="",this.chatWidgetWarning="",this.alertTitle="",this.showAlertTimer=0,this.alertVariant="warning",this.hostURL="",this.selectedTableRows=[],this.funnels=[],this.publishedPages=[],this.oAuthUrl=P,this.isAuthorizing=!1,this.publishedPageTablefields=b}onEnableTextWidget(e){this.chatWidgetEnable=String(e)}onApiKey(e){this.api_key=String(e)}async saveAPI(e){var t;this.api_key=this.api_key&&this.api_key.trim();const i={api_key:this.api_key};void 0!==e&&null!==e&&(i.enable_text_widget=this.chatWidgetEnable),this.isvalidApi=null,this.isAPIsaving=!0;let s={};if(s=await fetch(p("wp_save_options"),{method:"POST",body:JSON.stringify(i)}),console.log(s),null!==(t=s)&&void 0!==t&&t.ok){const t=await s.json();t.error&&(this.isvalidApi=!1,this.apiErrorMessage=t.message?v.INVALID_API_KEY:""),t.success&&(this.init(),this.isvalidApi=!0,t.warning_msg?void 0!==e&&null!==e&&"1"===this.chatWidgetEnable?this.chatWidgetWarning=t.warning_msg:(this.apiErrorMessage=t.warning_msg,this.chatWidgetWarning=""):this.chatWidgetWarning="",t.location_id&&(this.location_id=t.location_id),t.home_url&&(this.home_url=t.home_url),t.white_label_url?this.hostURL=t.white_label_url:this.hostURL=String(this.baseURL))}else 404===s.status&&(this.isvalidApi=!1,this.apiErrorMessage=h),console.error(await s.text());this.isAPIsaving=!1}async init(){const e=await fetch(p("funnels_get_list"));if(e.ok){const t=await e.json();if(t.error)return void this.showToast(v.FUNNELS_API_FAIL,!1);this.funnels=t.funnels,0===this.funnels.length&&this.showToast(v.NO_FUNNELS,!1,"warning")}else console.error(await e.text()),this.showToast(v.FUNNELS_API_FAIL,!1)}async fetchUserSettings(e){const t=await fetch(p("wp_get_lc_options"));if(t.ok){const i=await t.json();e&&e(i),i.api_key&&(this.api_key=i.api_key,this.isvalidApi=!i.text_widget_error&&i.api_key.length>0||null),i.enable_text_widget&&(this.chatWidgetEnable=i.enable_text_widget),i.location_id&&(this.location_id=i.location_id),i.text_widget_error&&(this.isvalidApi=!1,this.apiErrorMessage=i.warning_msg?i.warning_msg:v.INVALID_API_KEY),"1"===i.enable_text_widget&&i.warning_msg&&i.warning_msg.includes("chat")&&(this.chatWidgetWarning=i.warning_msg),i.home_url&&(this.home_url=i.home_url),i.white_label_url?this.hostURL=i.white_label_url:this.hostURL=String(this.baseURL)}else 404===t.status&&(this.isvalidApi=!1,this.apiErrorMessage=h),console.error(await t.text())}async fetchPublishedPages(){this.isBusy=!0;const e=await fetch(p("wp_get_all_posts"));if(e.ok){const t=await e.json();this.publishedPages=t}else console.error(await e.text()),this.showToast(v.POSTS_API_FAIL,!1);this.isBusy=!1}async checkForOAuthAuthorization(){var e;const t=new URLSearchParams(window.location.search);t.get("code")&&40==(null===(e=t.get("code"))||void 0===e?void 0:e.length)&&(this.isAuthorizing=!0,this.$bvModal.show("oauth-modal"));await fetch(p("wp_validate_oauth",{code:t.get("code")}))}async mounted(){var e;const t=new URLSearchParams(window.location.search);t.get("code")&&40==(null===(e=t.get("code"))||void 0===e?void 0:e.length)&&this.checkForOAuthAuthorization(),this.chatWidgetEnable=String(this.enableTextWidget),this.api_key=this.apiKey,this.hostURL=String(this.baseURL),this.fetchUserSettings(e=>{!e.api_key&&!e.oauth_access_token||e.text_widget_error||(this.init(),this.fetchPublishedPages())})}handleAddNewFunnel(){this.showAddNewFunnelModal=!0}editFunnel(e,t){this.editPost=t,this.showAddNewFunnelModal=!0}async onPostDelete(){if(this.editPost){var e;const t=await fetch(p("wp_delete_post",{post_id:null===(e=this.editPost)||void 0===e?void 0:e.template_id,force_delete:!0}));if(t.ok){const e=await t.json();e&&e.error?this.showToast(v.DELETE_POST_API_FAIL,!1):(this.showToast(v.POST_DELETED_SUCCESS,!0),this.fetchPublishedPages())}this.editPost=null}}deletePost(e,t){this.editPost=t}onRowSelected(e){this.selectedTableRows=e}showToast(e,t=!0,i){this.alertTitle=e,i||(i=t?"success":"danger"),this.alertVariant=i,this.showAlertTimer=5}onModalClose(e){this.showAddNewFunnelModal=!1,e&&(this.showToast(this.editPost?v.POST_UPDATED_SUCCESS:v.POST_CREATED_SUCCESS),this.fetchPublishedPages()),this.editPost=null}};Object(a["a"])([Object(o["b"])()],O.prototype,"enableTextWidget",void 0),Object(a["a"])([Object(o["b"])()],O.prototype,"apiKey",void 0),Object(a["a"])([Object(o["b"])()],O.prototype,"baseURL",void 0),Object(a["a"])([Object(o["d"])("enableTextWidget")],O.prototype,"onEnableTextWidget",null),Object(a["a"])([Object(o["d"])("apiKey")],O.prototype,"onApiKey",null),O=Object(a["a"])([Object(o["a"])({components:{PublishFunnel:T}})],O);var F=O,L=F,U=(i("95b1"),Object(A["a"])(L,r,d,!1,null,"7a6bd024",null)),M=U.exports;const D="https://app.leadconnectorhq.com";let N=class extends o["c"]{constructor(){super(...arguments),this.settings={base_URL:D}}mounted(){const e=document.getElementById("lead-connecter-settings-holder"),t=e?e.getAttribute("data-settings"):"";if(null!==t)try{this.settings={...this.settings,...JSON.parse(t)},this.settings.api_key=atob(this.settings.api_key||""),null!==e&&e.parentNode&&e.parentNode.removeChild(e)}catch(i){console.error(i)}}};N=Object(a["a"])([Object(o["a"])({components:{Settings:M}})],N);var I=N,R=I,j=(i("6538"),Object(A["a"])(R,n,l,!1,null,null,null)),W=j.exports,$=i("5f5b"),z=i("b1e0");i("f9e3"),i("2dd8");s["default"].config.productionTip=!1,s["default"].use($["a"]),s["default"].use(z["a"]),new s["default"]({render:e=>e(W)}).$mount("#app")},f6c0:function(e,t,i){}});